# TRANG THIẾT BỊ ĐIỀU TRA SỐ (DIGITAL FORENSICS EQUIPMENT)

Để thu thập bằng chứng an toàn và hiệu quả, điều tra viên cần chuẩn bị bộ công cụ kỹ lưỡng, tương đương với tiêu chuẩn phòng thí nghiệm.

## 1. Máy trạm hoặc Laptop pháp y (Forensic Laptop or Workstation)
* **Mục đích:** Dùng để thu thập bằng chứng tại hiện trường hoặc chụp ảnh bộ nhớ (RAM).
* **Công cụ:** Thường được cài đặt sẵn các bản phân phối Linux chuyên dụng cho điều tra số như **CAINE** hoặc **DEFT**.

## 2. Thiết bị chặn ghi (Write-Blockers)
Đây là thiết bị quan trọng nhất để đảm bảo tính toàn vẹn dữ liệu (Nguyên tắc ACPO số 1).
* **Chức năng:** Cho phép đọc dữ liệu từ thiết bị bằng chứng nhưng ngăn chặn tuyệt đối mọi hành động ghi/sửa xóa lên thiết bị đó.
* **Phân loại:**
    * **Phần cứng (Hardware):** Kết nối vật lý giữa ổ cứng và máy tính điều tra. An toàn và được ưa chuộng hơn.
    * **Phần mềm (Software):** Cài đặt trên máy tính điều tra (ví dụ: USB Write Blocker trên Windows registry).

## 3. Ổ cứng trắng (Blank Hard Drives)
* **Mục đích:** Dùng để chứa các bản sao (forensic images) của dữ liệu bằng chứng.
* **Yêu cầu:** Dung lượng phải lớn hơn ổ đĩa gốc (ví dụ: chuẩn bị các ổ 4.0TB) để đảm bảo chứa đủ dữ liệu sao chép từng bit (bit-by-bit copy).

## 4. Thiết bị chuyên dụng (Specialist Equipment)
Dùng cho các trường hợp đặc biệt như thiết bị di động hoặc môi trường không dây:
* **Túi Faraday / Hộp cách ly sóng (Wireless Stronghold/Faraday Boxes):** Dùng để đựng điện thoại, máy tính bảng. Nó chặn sóng vô tuyến (Wifi, 4G, Bluetooth) để ngăn kẻ xấu ra lệnh xóa dữ liệu từ xa (remote wipe).
* **Thiết bị gây nhiễu sóng (Phone Jammers):** Có tác dụng tương tự túi Faraday, chặn tín hiệu liên lạc tại hiện trường.
* **USB chuyên dụng (Dedicated Flash Drives):** Chứa sẵn các bộ công cụ phần mềm cứu hộ và điều tra như **EnCase**, **FTK**, **CSI Linux**, và **MacQuisiton**.


# THU THẬP BẰNG CHỨNG SỐ (DIGITAL EVIDENCE COLLECTION)

## 1. Nguyên tắc ACPO (ACPO Principles)
Đây là tiêu chuẩn vàng để đảm bảo tính pháp lý của bằng chứng số, được Hiệp hội Cảnh sát trưởng (ACPO) đưa ra. Mọi chuyên gia DFIR đều phải thuộc lòng 4 nguyên tắc này:

* **Nguyên tắc 1 (Không thay đổi):** Không được thực hiện hành động nào làm thay đổi dữ liệu trên máy tính hoặc phương tiện lưu trữ có khả năng được tin cậy trước tòa.
* **Nguyên tắc 2 (Trường hợp ngoại lệ):** Trong trường hợp cần thiết phải truy cập dữ liệu gốc (khiến dữ liệu bị thay đổi), người thực hiện phải có đủ năng lực, giải thích được hành động của mình và ý nghĩa của những thay đổi đó.
    * *Ví dụ:* Thu thập dữ liệu RAM trên máy đang chạy (Live Forensics) chắc chắn sẽ thay đổi dữ liệu hệ thống, nhưng cần thiết để lấy key giải mã.
* **Nguyên tắc 3 (Nhật ký kiểm tra - Audit Trail):** Phải tạo ra một bản ghi chi tiết về tất cả các quy trình đã áp dụng lên bằng chứng số. Một bên thứ ba độc lập phải có thể kiểm tra các quy trình này và đạt được kết quả tương tự.
* **Nguyên tắc 4 (Trách nhiệm):** Người phụ trách điều tra (Officer in Charge) có trách nhiệm đảm bảo tuân thủ các nguyên tắc trên.

---

## 2. Chuỗi hành trình bằng chứng (Chain of Custody - CoC)
CoC là tài liệu quan trọng nhất để chứng minh tính toàn vẹn của bằng chứng. Nếu CoC bị phá vỡ, bằng chứng có thể bị tòa án bác bỏ.

* **Định nghĩa:** Là tài liệu ghi lại trình tự thời gian của bằng chứng, bao gồm việc thu thập, lưu giữ, kiểm soát, chuyển giao, phân tích và tiêu hủy bằng chứng (vật lý hoặc điện tử).
* **Quy trình:**
    * Khi bằng chứng được thu thập, nó phải được ghi nhãn và niêm phong trong túi bằng chứng chống giả mạo (tamper-proof bag).
    * Mỗi khi bằng chứng được chuyển giao (ví dụ: từ người thu thập sang người phân tích), cả hai bên phải ký vào biểu mẫu CoC.
* **Mục đích:** Để chứng minh rằng bằng chứng được đưa ra tòa chính là bằng chứng đã được thu thập tại hiện trường và không bị thay đổi hoặc giả mạo trong quá trình lưu giữ.

---

## 3. Điều tra trực tiếp (Live Forensics)
Đây là xu hướng hiện đại, thay thế cho phương pháp truyền thống "rút phích cắm" (Dead Box Forensics) trong một số trường hợp cụ thể.

* **Tại sao cần Live Forensics?**
    * **Mã hóa toàn đĩa (Full Disk Encryption):** Nếu rút nguồn máy tính đang dùng BitLocker hoặc FileVault, dữ liệu sẽ bị khóa vĩnh viễn và không thể truy cập nếu không có khóa khôi phục.
    * **Dữ liệu trong RAM:** Rút nguồn sẽ làm mất dữ liệu trong RAM (như các kết nối mạng, tiến trình đang chạy, khóa giải mã, chat log chưa lưu).
* **Rủi ro:** Việc tương tác với máy tính đang chạy sẽ thay đổi dữ liệu (dấu vết bộ nhớ, log hệ thống). Điều tra viên phải cân nhắc giữa lợi ích của dữ liệu thu được và mức độ thay đổi gây ra (tuân thủ Nguyên tắc ACPO số 2).

---

## 4. Công cụ thu thập nhanh: KAPE
**KAPE (Kroll Artifact Parser and Extractor)** là công cụ tiêu chuẩn hiện nay để thu thập bằng chứng nhanh (Triage).

* **Chức năng:** KAPE cho phép thu thập các "tạo tác" (artifacts) quan trọng nhất trong vài phút thay vì mất hàng giờ để sao chép toàn bộ ổ cứng.
* **Cơ chế hoạt động:**
    * **Targets (Mục tiêu):** Định nghĩa *cái gì* cần thu thập. Ví dụ: Target "BrowserHistory" sẽ tìm và copy tất cả file lịch sử của Chrome, Firefox, Edge.
    * **Modules (Mô-đun):** Định nghĩa *làm gì* với dữ liệu đã thu thập. Ví dụ: Chạy công cụ `JLECmd` để phân tích Jump Lists hoặc `LECmd` để phân tích file LNK.
* **Lợi ích:** Giúp đội phản ứng sự cố nhanh chóng xác định phạm vi vụ việc trước khi quyết định có cần tạo ảnh ổ đĩa toàn bộ hay không.

---

## 5. Hủy hoại bằng chứng (Evidence Destruction)
Kẻ tấn công (và đôi khi là người dùng vô ý) thường sử dụng các kỹ thuật "Anti-Forensics" để cản trở điều tra.

* **Xóa an toàn (Secure Deletion/Wiping):** Sử dụng phần mềm (như SDelete, CCleaner) để ghi đè dữ liệu ngẫu nhiên lên vị trí file đã xóa, khiến việc khôi phục bằng công cụ truyền thống là không thể.
* **Thay đổi thời gian (Timestomping):** Kỹ thuật thay đổi timestamp (thời gian tạo, sửa đổi, truy cập) của tệp tin để trùng khớp với các tệp hệ thống hợp pháp (ví dụ: `svchost.exe`), nhằm lẩn trốn khỏi dòng thời gian (timeline) của điều tra viên.
* **Mã hóa (Encryption):** Sử dụng ransomware hoặc công cụ mã hóa để khóa dữ liệu, đòi hỏi điều tra viên phải tìm key trong RAM hoặc bản sao lưu.

---

## 6. Thiết bị cần thiết (Equipment)
Để thực hiện thu thập an toàn, cần có bộ công cụ chuyên dụng:
* **Write Blockers (Thiết bị chặn ghi):** Phần cứng bắt buộc phải có khi sao chép ổ cứng. Nó cho phép đọc dữ liệu nhưng ngăn chặn mọi lệnh ghi từ máy tính điều tra lên ổ cứng bằng chứng, đảm bảo tính toàn vẹn (ACPO 1).
* **Túi Faraday:** Dùng để đựng điện thoại di động/máy tính bảng nhằm chặn sóng vô tuyến (Wifi, 4G, Bluetooth), ngăn kẻ tấn công ra lệnh xóa dữ liệu từ xa (Remote Wipe).
* **Phần mềm:** FTK Imager, EnCase, KAPE, Autopsy.