# Windows Artifacts: Programs (Dấu vết chương trình)

## 1. Tổng quan về Windows Artifacts
Khi một người dùng mở một ứng dụng hoặc tập tin trên Windows, hệ điều hành sẽ tự động tạo ra các tập tin phụ trợ để hỗ trợ trải nghiệm người dùng (giúp mở lại nhanh hơn, lưu danh sách xem gần đây...). Đối với người làm bảo mật (Blue Team), những tập tin này là bằng chứng quan trọng để điều tra hành vi người dùng.

Bài học này tập trung vào 3 loại dấu vết chính:
* **LNK Files** (Shortcut)
* **Prefetch Files**
* **Jump Lists**

---

## 2. Phân tích LNK Files (Shortcut Analysis)

### LNK Files là gì?
LNK files là các tệp đường tắt (shortcuts) mà Windows sử dụng để liên kết đến một tệp khác.

* **Cơ chế:** Khi bạn mở một tệp, Windows thường tự động tạo một LNK file trong thư mục "Recent" (Gần đây). Ngay cả khi tệp gốc bị xóa hoặc nằm trên USB đã bị rút ra, LNK file vẫn còn đó và chứa thông tin về tệp gốc.
* **Vị trí lưu trữ:**
    ```text
    C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Recent
    ```

### Thông tin thu thập được
Khi phân tích tệp LNK, bạn có thể biết:
* Đường dẫn đầy đủ đến tệp gốc (Linked path).
* Thời gian tạo, sửa đổi và truy cập cuối cùng (Created, Modified, Last Accessed dates).
* Kích thước tệp (File size).

### Cách thực hành
* **Công cụ sử dụng:** `Windows File Analyzer`.
* **Quy trình:**
    1.  Mở công cụ, chọn **File > Analyze Shortcuts**.
    2.  Chọn đường dẫn đến thư mục `Recent` của user cần điều tra.
    3.  Công cụ sẽ liệt kê tất cả các file LNK. Bạn có thể xem dưới dạng bảng hoặc nhấp đúp vào từng file để xem chi tiết.

---

## 3. Phân tích Prefetch Files

### Prefetch Files là gì?
Đây là tính năng của Windows giúp tăng tốc độ khởi động ứng dụng. Khi một chương trình chạy, Windows tạo ra file `.pf` chứa thông tin về cách chương trình đó được tải vào bộ nhớ.

* **Vị trí lưu trữ:**
    ```text
    C:\Windows\Prefetch
    ```
    > **Lưu ý:** Bạn cần quyền Admin (Administrator) mới có thể truy cập thư mục này.

### Thông tin thu thập được (Rất quan trọng)
Prefetch cung cấp những bằng chứng "thép" về việc thực thi ứng dụng:
* **Execution Count:** Chương trình đã được chạy bao nhiêu lần.
* **Last Run Time:** Lần cuối cùng chương trình chạy là khi nào.
* **Created/Install Time:** Thời điểm chương trình được tạo hoặc cài đặt.
* **File Path:** Đường dẫn đến file thực thi (`.exe`).

### Cách thực hành 
* **Công cụ sử dụng:** `PECmd.exe` (Prefetch Explorer Command Line).
* **Quy trình:**
    1.  Mở Command Prompt (CMD) tại thư mục chứa công cụ.
    2.  Sử dụng lệnh theo cú pháp:
        ```cmd
        PECmd.exe -f "đường_dẫn_đến_file_pf" [--csv "đường dẫn xuất ra"]
        ```
    3.  **Ví dụ:**
        ```cmd
        PECmd.exe -f "C:\Users\JBeam\Desktop\OUTLOOK.EXE-74475F66.pf"
        ```
    4.  Kết quả trả về sẽ hiển thị chi tiết số lần chạy (Run Count) và các mốc thời gian cụ thể.

---

## 4. Jump Lists (Danh sách truy cập nhanh)

### Jump List là gì?
Đây là tính năng khi bạn nhấp chuột phải vào biểu tượng ứng dụng trên thanh Taskbar, nó hiện ra danh sách các tệp đã mở gần đây hoặc được ghim (pinned).

### Hai loại file Jump List:
1.  **automaticDestinations-ms:** Tự động tạo bởi Windows dựa trên thói quen sử dụng.
2.  **customDestinations-ms:** Tạo ra khi người dùng chủ động ghim (pin) file.

* **Vị trí lưu trữ:** Nằm trong thư mục `AppData\Roaming\Microsoft\Windows\Recent\` nhưng chia vào 2 thư mục con là `AutomaticDestinations` và `CustomDestinations`.

### Công cụ phân tích
* Sử dụng công cụ **Jumplist Explorer** để đọc các file này.

---

## Tổng kết quy trình điều tra

Để điều tra xem người dùng đã làm gì trên máy tính, bạn sẽ thực hiện theo trình tự:

1.  **Kiểm tra Prefetch** (`C:\Windows\Prefetch`):
    * Để xem người dùng đã chạy những chương trình nào (ví dụ: CCleaner, Tor Browser, hay Malware) và chạy bao nhiêu lần.
2.  **Kiểm tra LNK Files** (`...\Recent`):
    * Để xem người dùng đã mở những tài liệu cụ thể nào (ví dụ: `Danh_sach_mat_khau.txt` hay `Ke_hoach_tan_cong.docx`), ngay cả khi file gốc đã bị xóa.
3.  **Kiểm tra Jump Lists:**
    * Để xác nhận thêm về tần suất tương tác và các tệp tin quan trọng mà người dùng hay truy cập.