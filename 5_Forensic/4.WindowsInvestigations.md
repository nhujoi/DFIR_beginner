# Windows Artifacts: Programs (Dáº¥u váº¿t chÆ°Æ¡ng trÃ¬nh)

## 1. Tá»•ng quan vá» Windows Artifacts
Khi má»™t ngÆ°á»i dÃ¹ng má»Ÿ má»™t á»©ng dá»¥ng hoáº·c táº­p tin trÃªn Windows, há»‡ Ä‘iá»u hÃ nh sáº½ tá»± Ä‘á»™ng táº¡o ra cÃ¡c táº­p tin phá»¥ trá»£ Ä‘á»ƒ há»— trá»£ tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng (giÃºp má»Ÿ láº¡i nhanh hÆ¡n, lÆ°u danh sÃ¡ch xem gáº§n Ä‘Ã¢y...). Äá»‘i vá»›i ngÆ°á»i lÃ m báº£o máº­t (Blue Team), nhá»¯ng táº­p tin nÃ y lÃ  báº±ng chá»©ng quan trá»ng Ä‘á»ƒ Ä‘iá»u tra hÃ nh vi ngÆ°á»i dÃ¹ng.

BÃ i há»c nÃ y táº­p trung vÃ o 3 loáº¡i dáº¥u váº¿t chÃ­nh:
* **LNK Files** (Shortcut)
* **Prefetch Files**
* **Jump Lists**

---

## 2. PhÃ¢n tÃ­ch LNK Files (Shortcut Analysis)

### LNK Files lÃ  gÃ¬?
LNK files lÃ  cÃ¡c tá»‡p Ä‘Æ°á»ng táº¯t (shortcuts) mÃ  Windows sá»­ dá»¥ng Ä‘á»ƒ liÃªn káº¿t Ä‘áº¿n má»™t tá»‡p khÃ¡c.

* **CÆ¡ cháº¿:** Khi báº¡n má»Ÿ má»™t tá»‡p, Windows thÆ°á»ng tá»± Ä‘á»™ng táº¡o má»™t LNK file trong thÆ° má»¥c "Recent" (Gáº§n Ä‘Ã¢y). Ngay cáº£ khi tá»‡p gá»‘c bá»‹ xÃ³a hoáº·c náº±m trÃªn USB Ä‘Ã£ bá»‹ rÃºt ra, LNK file váº«n cÃ²n Ä‘Ã³ vÃ  chá»©a thÃ´ng tin vá» tá»‡p gá»‘c.
* **Vá»‹ trÃ­ lÆ°u trá»¯:**
    ```text
    C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Recent
    ```

### ThÃ´ng tin thu tháº­p Ä‘Æ°á»£c
Khi phÃ¢n tÃ­ch tá»‡p LNK, báº¡n cÃ³ thá»ƒ biáº¿t:
* ÄÆ°á»ng dáº«n Ä‘áº§y Ä‘á»§ Ä‘áº¿n tá»‡p gá»‘c (Linked path).
* Thá»i gian táº¡o, sá»­a Ä‘á»•i vÃ  truy cáº­p cuá»‘i cÃ¹ng (Created, Modified, Last Accessed dates).
* KÃ­ch thÆ°á»›c tá»‡p (File size).

### CÃ¡ch thá»±c hÃ nh
* **CÃ´ng cá»¥ sá»­ dá»¥ng:** `Windows File Analyzer`.
* **Quy trÃ¬nh:**
    1.  Má»Ÿ cÃ´ng cá»¥, chá»n **File > Analyze Shortcuts**.
    2.  Chá»n Ä‘Æ°á»ng dáº«n Ä‘áº¿n thÆ° má»¥c `Recent` cá»§a user cáº§n Ä‘iá»u tra.
    3.  CÃ´ng cá»¥ sáº½ liá»‡t kÃª táº¥t cáº£ cÃ¡c file LNK. Báº¡n cÃ³ thá»ƒ xem dÆ°á»›i dáº¡ng báº£ng hoáº·c nháº¥p Ä‘Ãºp vÃ o tá»«ng file Ä‘á»ƒ xem chi tiáº¿t.

---

## 3. PhÃ¢n tÃ­ch Prefetch Files

### Prefetch Files lÃ  gÃ¬?
ÄÃ¢y lÃ  tÃ­nh nÄƒng cá»§a Windows giÃºp tÄƒng tá»‘c Ä‘á»™ khá»Ÿi Ä‘á»™ng á»©ng dá»¥ng. Khi má»™t chÆ°Æ¡ng trÃ¬nh cháº¡y, Windows táº¡o ra file `.pf` chá»©a thÃ´ng tin vá» cÃ¡ch chÆ°Æ¡ng trÃ¬nh Ä‘Ã³ Ä‘Æ°á»£c táº£i vÃ o bá»™ nhá»›.

* **Vá»‹ trÃ­ lÆ°u trá»¯:**
    ```text
    C:\Windows\Prefetch
    ```
    > **LÆ°u Ã½:** Báº¡n cáº§n quyá»n Admin (Administrator) má»›i cÃ³ thá»ƒ truy cáº­p thÆ° má»¥c nÃ y.

### ThÃ´ng tin thu tháº­p Ä‘Æ°á»£c (Ráº¥t quan trá»ng)
Prefetch cung cáº¥p nhá»¯ng báº±ng chá»©ng "thÃ©p" vá» viá»‡c thá»±c thi á»©ng dá»¥ng:
* **Execution Count:** ChÆ°Æ¡ng trÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c cháº¡y bao nhiÃªu láº§n.
* **Last Run Time:** Láº§n cuá»‘i cÃ¹ng chÆ°Æ¡ng trÃ¬nh cháº¡y lÃ  khi nÃ o.
* **Created/Install Time:** Thá»i Ä‘iá»ƒm chÆ°Æ¡ng trÃ¬nh Ä‘Æ°á»£c táº¡o hoáº·c cÃ i Ä‘áº·t.
* **File Path:** ÄÆ°á»ng dáº«n Ä‘áº¿n file thá»±c thi (`.exe`).

### CÃ¡ch thá»±c hÃ nh 
* **CÃ´ng cá»¥ sá»­ dá»¥ng:** `PECmd.exe` (Prefetch Explorer Command Line).
* **Quy trÃ¬nh:**
    1.  Má»Ÿ Command Prompt (CMD) táº¡i thÆ° má»¥c chá»©a cÃ´ng cá»¥.
    2.  Sá»­ dá»¥ng lá»‡nh theo cÃº phÃ¡p:
        ```cmd
        PECmd.exe -f "Ä‘Æ°á»ng_dáº«n_Ä‘áº¿n_file_pf" [--csv "Ä‘Æ°á»ng dáº«n xuáº¥t ra"]
        ```
    3.  **VÃ­ dá»¥:**
        ```cmd
        PECmd.exe -f "C:\Users\JBeam\Desktop\OUTLOOK.EXE-74475F66.pf"
        ```
    4.  Káº¿t quáº£ tráº£ vá» sáº½ hiá»ƒn thá»‹ chi tiáº¿t sá»‘ láº§n cháº¡y (Run Count) vÃ  cÃ¡c má»‘c thá»i gian cá»¥ thá»ƒ.

---

## 4. Jump Lists (Danh sÃ¡ch truy cáº­p nhanh)

### Jump List lÃ  gÃ¬?
ÄÃ¢y lÃ  tÃ­nh nÄƒng khi báº¡n nháº¥p chuá»™t pháº£i vÃ o biá»ƒu tÆ°á»£ng á»©ng dá»¥ng trÃªn thanh Taskbar, nÃ³ hiá»‡n ra danh sÃ¡ch cÃ¡c tá»‡p Ä‘Ã£ má»Ÿ gáº§n Ä‘Ã¢y hoáº·c Ä‘Æ°á»£c ghim (pinned).

### Hai loáº¡i file Jump List:
1.  **automaticDestinations-ms:** Tá»± Ä‘á»™ng táº¡o bá»Ÿi Windows dá»±a trÃªn thÃ³i quen sá»­ dá»¥ng.
2.  **customDestinations-ms:** Táº¡o ra khi ngÆ°á»i dÃ¹ng chá»§ Ä‘á»™ng ghim (pin) file.

* **Vá»‹ trÃ­ lÆ°u trá»¯:** Náº±m trong thÆ° má»¥c `AppData\Roaming\Microsoft\Windows\Recent\` nhÆ°ng chia vÃ o 2 thÆ° má»¥c con lÃ  `AutomaticDestinations` vÃ  `CustomDestinations`.

### CÃ´ng cá»¥ phÃ¢n tÃ­ch
* Sá»­ dá»¥ng cÃ´ng cá»¥ **Jumplist Explorer** Ä‘á»ƒ Ä‘á»c cÃ¡c file nÃ y.

---

## Tá»•ng káº¿t quy trÃ¬nh Ä‘iá»u tra

Äá»ƒ Ä‘iá»u tra xem ngÆ°á»i dÃ¹ng Ä‘Ã£ lÃ m gÃ¬ trÃªn mÃ¡y tÃ­nh, báº¡n sáº½ thá»±c hiá»‡n theo trÃ¬nh tá»±:

1.  **Kiá»ƒm tra Prefetch** (`C:\Windows\Prefetch`):
    * Äá»ƒ xem ngÆ°á»i dÃ¹ng Ä‘Ã£ cháº¡y nhá»¯ng chÆ°Æ¡ng trÃ¬nh nÃ o (vÃ­ dá»¥: CCleaner, Tor Browser, hay Malware) vÃ  cháº¡y bao nhiÃªu láº§n.
2.  **Kiá»ƒm tra LNK Files** (`...\Recent`):
    * Äá»ƒ xem ngÆ°á»i dÃ¹ng Ä‘Ã£ má»Ÿ nhá»¯ng tÃ i liá»‡u cá»¥ thá»ƒ nÃ o (vÃ­ dá»¥: `Danh_sach_mat_khau.txt` hay `Ke_hoach_tan_cong.docx`), ngay cáº£ khi file gá»‘c Ä‘Ã£ bá»‹ xÃ³a.
3.  **Kiá»ƒm tra Jump Lists:**
    * Äá»ƒ xÃ¡c nháº­n thÃªm vá» táº§n suáº¥t tÆ°Æ¡ng tÃ¡c vÃ  cÃ¡c tá»‡p tin quan trá»ng mÃ  ngÆ°á»i dÃ¹ng hay truy cáº­p.



# Windows Artifacts: Internet Browsers (Äiá»u tra TrÃ¬nh duyá»‡t Web)

## 1. Tá»•ng quan
TrÃ¬nh duyá»‡t web lÃ  "má» vÃ ng" thÃ´ng tin trong Ä‘iá»u tra sá»‘. ChÃºng lÆ°u láº¡i dáº¥u váº¿t vá» thÃ³i quen cá»§a ngÆ°á»i dÃ¹ng, cÃ¡c trang web Ä‘Ã£ truy cáº­p, vÃ  cÃ¡c tá»‡p tin Ä‘Ã£ táº£i vá».

---

## 2. CÃ¡c dáº¥u váº¿t quan trá»ng (Artifacts)
Khi phÃ¢n tÃ­ch trÃ¬nh duyá»‡t, chÃºng ta tÃ¬m kiáº¿m cÃ¡c thÃ´ng tin sau:

* **URLs Visited:** Danh sÃ¡ch cÃ¡c trang web Ä‘Ã£ truy cáº­p.
* **Downloaded Files:** CÃ¡c táº­p tin Ä‘Ã£ táº£i vá» (giÃºp xÃ¡c Ä‘á»‹nh nguá»“n gá»‘c mÃ£ Ä‘á»™c).
* **Searches:** Tá»« khÃ³a tÃ¬m kiáº¿m (trÃªn Google, Bing, v.v.).
* **Cookies:** Dá»¯ liá»‡u phiÃªn Ä‘Äƒng nháº­p.
* **Cached Images/Webpages:** HÃ¬nh áº£nh hoáº·c ná»™i dung trang web Ä‘Æ°á»£c lÆ°u láº¡i trong bá»™ nhá»› Ä‘á»‡m (giÃºp xem láº¡i ná»™i dung trang web ngay cáº£ khi mÃ¡y khÃ´ng cÃ³ máº¡ng hoáº·c trang web gá»‘c Ä‘Ã£ bá»‹ xÃ³a).

---

## 3. PhÆ°Æ¡ng phÃ¡p 1: Thu tháº­p dá»¯ liá»‡u báº±ng KAPE (Live Acquisition)

KAPE giÃºp thu tháº­p dá»¯ liá»‡u tá»« há»‡ thá»‘ng Ä‘ang cháº¡y (Live system) má»™t cÃ¡ch nhanh chÃ³ng.

### Quy trÃ¬nh thá»±c hiá»‡n:
1.  **Má»Ÿ KAPE (`gkape.exe`)**.
2.  **Target Source:** Chá»n á»• Ä‘Ä©a há»‡ thá»‘ng (thÆ°á»ng lÃ  `C:\`).
3.  **Target Destination:** Chá»n thÆ° má»¥c lÆ°u káº¿t quáº£ (VÃ­ dá»¥: `Desktop\KAPE Browser Forensics`).
4.  **Select Targets:** TÃ¬m vÃ  tÃ­ch chá»n cÃ¡c má»¥c sau trong danh sÃ¡ch:
    * `Chrome`
    * `Edge`
    * `Firefox`
5.  **Execute:** Nháº¥n nÃºt thá»±c thi á»Ÿ gÃ³c dÆ°á»›i bÃªn pháº£i.

### Káº¿t quáº£ Ä‘áº§u ra:
KAPE sáº½ giá»¯ nguyÃªn cáº¥u trÃºc thÆ° má»¥c gá»‘c. VÃ­ dá»¥ Ä‘Æ°á»ng dáº«n Chrome sáº½ náº±m táº¡i:
`KAPE Browser Forensics\C\Users\%USERNAME%\AppData\Local\Google\Chrome\User Data`

---

## 4. PhÆ°Æ¡ng phÃ¡p 2: Bá»™ cÃ´ng cá»¥ Browser History (BHC & BHV)

ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p dÃ¹ng bá»™ Ä‘Ã´i cÃ´ng cá»¥ cá»§a Foxton Forensics Ä‘á»ƒ phÃ¢n tÃ­ch trá»±c quan.

### BÆ°á»›c A: Thu tháº­p báº±ng Browser History Capturer (BHC)
DÃ¹ng cÃ´ng cá»¥ nÃ y Ä‘á»ƒ trÃ­ch xuáº¥t dá»¯ liá»‡u, Ä‘áº·c biá»‡t há»¯u Ã­ch vÃ¬ nÃ³ vÆ°á»£t qua Ä‘Æ°á»£c cÆ¡ cháº¿ khÃ³a file cá»§a Windows (file locking) khi trÃ¬nh duyá»‡t Ä‘ang má»Ÿ.

1.  **Capture Settings:**
    * **User Profile:** Chá»n user cáº§n Ä‘iá»u tra (VÃ­ dá»¥: `nhujo` hoáº·c `ADMIN`).
    * **Browsers:** TÃ­ch chá»n Edge, Chrome, Firefox.
    * **Data:** TÃ­ch chá»n History, Cache, Archived History.
2.  **Destination:** Máº·c Ä‘á»‹nh sáº½ táº¡o thÆ° má»¥c `Capture` ngay táº¡i nÆ¡i cháº¡y tool.
3.  Nháº¥n nÃºt **Capture**.

> **ğŸ’¡ Máº¹o cho UCBrowser/Cá»‘c Cá»‘c:**
> BHC khÃ´ng há»— trá»£ sáºµn cÃ¡c trÃ¬nh duyá»‡t nÃ y. Báº¡n cáº§n vÃ o Ä‘Æ°á»ng dáº«n `AppData\Local\...` cá»§a trÃ¬nh duyá»‡t Ä‘Ã³, copy thá»§ cÃ´ng file `History` ra ngoÃ i vÃ  náº¡p vÃ o BHV nhÆ° hÆ°á»›ng dáº«n á»Ÿ BÆ°á»›c B.

### BÆ°á»›c B: PhÃ¢n tÃ­ch báº±ng Browser History Viewer (BHV)
1.  Má»Ÿ **Browser History Viewer**.
2.  Chá»n **File > Load History**.
3.  Chá»n dÃ²ng **"Load history captured using the Browser History Capturer tool"**.
4.  Trá» Ä‘áº¿n thÆ° má»¥c `Capture` vá»«a táº¡o á»Ÿ BÆ°á»›c A.

---

## 5. Giao diá»‡n phÃ¢n tÃ­ch (Browser History Viewer)

Sau khi náº¡p dá»¯ liá»‡u, giao diá»‡n sáº½ chia lÃ m 3 vÃ¹ng:

### Pane 1: Chi tiáº¿t dá»¯ liá»‡u (TrÃªn cÃ¹ng)
* **Website History:** Hiá»ƒn thá»‹ URL, tiÃªu Ä‘á» trang, thá»i gian truy cáº­p (Date Visited), sá»‘ láº§n truy cáº­p (Visit Count).
* **Cached Images:** Xem láº¡i cÃ¡c hÃ¬nh áº£nh Ä‘Ã£ táº£i vá» tá»« web.
* **Cached Web Pages:** Xem ná»™i dung trang web Ä‘Ã£ lÆ°u.

### Pane 2: Biá»ƒu Ä‘á»“ (DÆ°á»›i cÃ¹ng)
* Hiá»ƒn thá»‹ táº§n suáº¥t truy cáº­p theo thá»i gian (Timeline). GiÃºp phÃ¡t hiá»‡n cÃ¡c Ä‘á»£t truy cáº­p báº¥t thÆ°á»ng.

### Pane 3: Bá»™ lá»c (BÃªn pháº£i)
* **Filter by keyword:** Nháº­p tá»« khÃ³a nghi váº¥n (vÃ­ dá»¥: "malware", "hack", "download").
* **Filter by web browser:** Lá»c riÃªng lá»‹ch sá»­ cá»§a Chrome hoáº·c Edge.

---
